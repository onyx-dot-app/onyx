{
  "id": "https://github.com/onyx-dot-app/onyx#87",
  "semantic_identifier": "87: feat: Add read API for Issue History timeline with stable ordering, cursor pagination, and permissions",
  "title": null,
  "source": "github",
  "doc_updated_at": "2025-05-06",
  "metadata": {
    "object_type": "PullRequest",
    "id": "87",
    "merged": "True",
    "state": "closed",
    "user": {
      "login": "kenji_watanabe",
      "name": "kenji_watanabe",
      "email": "kenji_watanabe@netherite-extraction.onyx.app"
    },
    "assignees": [
      {
        "login": "tyler_jenkins",
        "name": "tyler_jenkins",
        "email": "tyler_jenkins@netherite-extraction.onyx.app"
      }
    ],
    "repo": "netherite-ext/gold",
    "num_commits": "3",
    "num_files_changed": "52",
    "labels": [],
    "created_at": "2025-05-06",
    "updated_at": "2025-05-06",
    "closed_at": "2025-05-09"
  },
  "doc_metadata": {
    "repo": "netherite-ext/gold",
    "hierarchy": {
      "source_path": [
        "netherite-ext",
        "gold",
        "pull_requests"
      ],
      "owner": "netherite-ext",
      "repo": "gold",
      "object_type": "pull_request"
    }
  },
  "sections": [
    {
      "text": "## Description\r\n\r\n### Summary\nThis PR implements the backend read path for an Issue\u2019s `issue_history` timeline, providing a stable chronological feed suitable for UI timeline rendering.\n\n### What\u2019s included\n- **New endpoint/service** to fetch an Issue\u2019s history events with:\n  - **Stable ordering** (chronological) with deterministic tie-breaking.\n  - **Cursor-based pagination** (forward pagination) for infinite-scroll timelines.\n  - **Permission enforcement** aligned with existing Issue visibility/access rules.\n- **Normalized actor metadata** returned for each event (consistent `actor` shape), with support for system/unknown actors.\n- **Consistent, minimal payloads per event type** with a shared envelope and type-specific `data`:\n  - `status_changed`\n  - `priority_changed`\n  - `issue_merged` / `issue_split`\n  - `note_added`\n  - `external_link_added`\n\n### Implementation details (high level)\n- Adds a dedicated query path for `issue_history` that:\n  - Orders by `(occurred_at, id)` to guarantee stable pagination.\n  - Uses an opaque cursor encoding the last seen `(occurred_at, id)`.\n  - Applies server-side filtering/redaction where needed (e.g., when actor/details are not visible to the caller).\n- Introduces/extends serializers/mappers to enforce the shared event envelope:\n  - `id`, `type`, `occurredAt`, `actor`, `data`\n- Reuses existing authorization checks for Issue access, and ensures history is not accessible if the Issue itself is not.\n\n### Tests\n- Adds basic coverage for:\n  - **Deterministic ordering** across mixed event types.\n  - **Cursor pagination correctness** (no gaps/dupes between pages).\n  - **Redaction/visibility behavior** for restricted fields where applicable.\n\n### Notes for consumers\n- API responses are intentionally minimal and stable; consumers should rely on `type` + `data` for rendering and treat unknown `type`s as forward-compatible.\r\n\r\n## How Has This Been Tested?\r\n\r\nstaging\r\n",
      "link": "https://github.com/onyx-dot-app/onyx#87"
    }
  ],
  "primary_owners": [],
  "secondary_owners": []
}