{
  "id": "https://github.com/onyx-dot-app/onyx#170",
  "semantic_identifier": "170: feat: Warning alerts v2: Deterministic manager routing via CRM hierarchy with fallbacks + routing logs",
  "title": null,
  "source": "github",
  "doc_updated_at": "2025-09-30",
  "metadata": {
    "object_type": "PullRequest",
    "id": "170",
    "merged": "False",
    "state": "open",
    "user": {
      "login": "michael_anderson",
      "name": "michael_anderson",
      "email": "michael_anderson@netherite-extraction.onyx.app"
    },
    "assignees": [
      {
        "login": "jiwon_kang",
        "name": "jiwon_kang",
        "email": "jiwon_kang@netherite-extraction.onyx.app"
      }
    ],
    "repo": "netherite-ext/gold",
    "num_commits": "5",
    "num_files_changed": "14",
    "labels": [],
    "created_at": "2025-09-30",
    "updated_at": "2025-09-30",
    "closed_at": ""
  },
  "doc_metadata": {
    "repo": "netherite-ext/gold",
    "hierarchy": {
      "source_path": [
        "netherite-ext",
        "gold",
        "pull_requests"
      ],
      "owner": "netherite-ext",
      "repo": "gold",
      "object_type": "pull_request"
    }
  },
  "sections": [
    {
      "text": "## Description\r\n\r\n## Summary\nFixes Warning Alerts v2 recipient selection so alerts are routed to the correct manager derived from CRM account/opportunity ownership hierarchy, instead of defaulting to the deal owner or a global fallback channel.\n\n## Implementation\n- Adds a routing resolver that determines the intended manager recipient using CRM-derived owner/manager fields (account + opportunity context).\n- Implements deterministic fallback ordering when manager data is missing/stale (e.g., missing manager on owner, missing owner, unmapped manager), ensuring a single predictable recipient path.\n- Preserves alert payload/content; only changes the destination recipient selection.\n- Adds lightweight structured logging for:\n  - chosen recipient (user/channel identifier)\n  - routing source (account vs opportunity)\n  - fallback reason code (e.g., MANAGER_MISSING, OWNER_MISSING, STALE_CRM_DATA, DEFAULT_CHANNEL)\n\n## Behavior changes\n- Alerts now prefer the manager in the relevant management chain when available.\n- When hierarchy data is unavailable, routing follows the new deterministic fallback rather than implicitly defaulting to deal owner.\n\n## Notes\n- No schema or alert content changes.\n- Logging is intentionally minimal to support troubleshooting without increasing noise (info-level, keyed fields).\r\n\r\n## How Has This Been Tested?\r\n\r\nstaging\r\n",
      "link": "https://github.com/onyx-dot-app/onyx#170"
    }
  ],
  "primary_owners": [],
  "secondary_owners": []
}