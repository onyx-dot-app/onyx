{
  "id": "https://github.com/onyx-dot-app/onyx#96",
  "semantic_identifier": "96: feat: issue_history v2: Persist ownership fields and emit assignment/ownership-change timeline events",
  "title": null,
  "source": "github",
  "doc_updated_at": "2025-08-12",
  "metadata": {
    "object_type": "PullRequest",
    "id": "96",
    "merged": "True",
    "state": "closed",
    "user": {
      "login": "kenji_watanabe",
      "name": "kenji_watanabe",
      "email": "kenji_watanabe@netherite-extraction.onyx.app"
    },
    "assignees": [
      {
        "login": "tyler_jenkins",
        "name": "tyler_jenkins",
        "email": "tyler_jenkins@netherite-extraction.onyx.app"
      }
    ],
    "repo": "netherite-ext/gold",
    "num_commits": "8",
    "num_files_changed": "95",
    "labels": [],
    "created_at": "2025-08-12",
    "updated_at": "2025-08-12",
    "closed_at": "2025-09-09"
  },
  "doc_metadata": {
    "repo": "netherite-ext/gold",
    "hierarchy": {
      "source_path": [
        "netherite-ext",
        "gold",
        "pull_requests"
      ],
      "owner": "netherite-ext",
      "repo": "gold",
      "object_type": "pull_request"
    }
  },
  "sections": [
    {
      "text": "## Description\r\n\r\n### Summary\nThis PR extends the issue_history v2 model to represent explicit ownership state (current owner, team, and assignee source) and to capture ownership changes as first-class timeline events. Ingestion/sync is updated so assignments coming from connected delivery tools (Linear/Jira) and manual triage updates are persisted in a consistent format and can be queried/displayed alongside other issue history events.\n\n### Key changes\n- **Data model (issue_history v2)**\n  - Adds ownership-related columns/fields for the current state:\n    - `current_owner_id` (actor/user identifier)\n    - `current_team_id`\n    - `assignee_source` (e.g., `LINEAR`, `JIRA`, `MANUAL_TRIAGE`)\n  - Introduces a new timeline event type for ownership transitions:\n    - `ASSIGNMENT_CHANGED` (captures `from_owner`, `to_owner`, `from_team`, `to_team`, and `source`)\n\n- **Event generation + persistence**\n  - Updates sync pipelines to detect assignment/ownership deltas during ingestion.\n  - Writes ownership-change events to the issue history timeline while also updating the \u201ccurrent ownership\u201d fields.\n  - Normalizes data across sources so tool-driven updates and manual triage produce identical event shapes.\n\n- **Query/display support**\n  - Updates issue history queries/serializers so ownership fields can be fetched with the issue record and assignment events appear in the ordered history stream.\n  - Ensures downstream consumers can use assignment events for SLA timers and decision notes.\n\n### Migrations / deployment notes\n- Includes a schema migration for new ownership fields and the new timeline event type.\n- Backfill is not performed in this PR; ownership events/fields will be populated for changes observed after deployment.\n\n### Testing\n- Adds/updates unit tests for:\n  - assignment delta detection\n  - correct event payload generation per source\n  - persistence of current ownership fields\n  - ordering and querying of assignment events in issue history\n\r\n\r\n## How Has This Been Tested?\r\n\r\nlocal\r\n",
      "link": "https://github.com/onyx-dot-app/onyx#96"
    }
  ],
  "primary_owners": [],
  "secondary_owners": []
}