{
  "id": "c74eb0dfa470430e90ed750116a21aca",
  "semantic_identifier": "Design--[BUG] Add regression tests to prevent generic positioning when customer evidence exists.docx",
  "title": null,
  "source": "google_doc",
  "doc_updated_at": "2025-05-16",
  "metadata": {
    "owner_names": ""
  },
  "doc_metadata": {
    "hierarchy": {
      "source_path": [
        "My Drive"
      ],
      "drive_id": null,
      "file_name": "Design--[BUG] Add regression tests to prevent generic positioning when customer evidence exists.docx",
      "mime_type": "application/vnd.openxmlformats-officedocument.wordprocessingml.document"
    }
  },
  "sections": [
    {
      "text": "We will add a small regression test suite around the positioning generator to ensure it does not produce generic, uncited messaging when customer evidence exists for the requested segment. The core invariant: for evidence-rich inputs, the generated positioning must include at least one verbatim customer snippet (quoted text) and a citation that points to the originating evidence record. Conversely, when evidence is sparse, the generator must explicitly signal \u201clow evidence\u201d (or the existing equivalent flag) rather than filling gaps with generic claims presented as facts.\n\nImplementation will introduce deterministic fixtures and a thin test harness that runs the generator with fixed inputs and asserts over the structured output (preferred) or rendered text (fallback). We\u2019ll add three fixture buckets: (a) evidence-rich segments with multiple strong customer quotes; (b) sparse-evidence segments with zero/near-zero usable quotes; and (c) mixed-source evidence (e.g., interviews + tickets + calls) where we can validate the generator\u2019s source attribution and citation formatting per snippet. Fixtures should be stable, minimal, and stored as versioned JSON (or the existing evidence schema) so failures are diffable and do not depend on external services.\n\nAcceptance criteria: for (a), tests fail if output contains any \u201ctop-level claims\u201d that lack citations and also fails if no verbatim snippet appears; for (b), tests fail if output does not include the explicit low-evidence indicator; for (c), tests fail if a snippet\u2019s citation does not match its source record (wrong type/id/url) or if citations are missing. We\u2019ll also include a negative test that seeds evidence-rich input and asserts that the presence of generic, uncited statements triggers a hard failure, preventing regression to \u201cgeneric positioning\u201d behavior.\n\nRollout is test-only (no runtime behavior change), added to CI as a required check for merges touching the generator or prompting logic. We\u2019ll keep the assertions resilient to minor phrasing variation by checking for the presence of exact fixture snippets and machine-readable citation fields rather than full-text snapshot matching; if the generator currently does not expose structured citations, we will add a minimal, backwards-compatible metadata field (e.g., `citations: [{sourceId, sourceType, snippet}]`) to make these tests reliable.",
      "link": "https://www.onyx.app/86988"
    }
  ],
  "primary_owners": [
    "jiwon_kang"
  ],
  "secondary_owners": []
}