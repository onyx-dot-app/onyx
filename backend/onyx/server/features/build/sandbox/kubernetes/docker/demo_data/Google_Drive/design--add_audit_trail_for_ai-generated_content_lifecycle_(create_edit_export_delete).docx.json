{
  "id": "2d9442c978a94b8081a242d115474ce0",
  "semantic_identifier": "Design--Add audit trail for AI-generated content lifecycle (create/edit/export/delete).docx",
  "title": null,
  "source": "google_doc",
  "doc_updated_at": "2025-09-26",
  "metadata": {
    "owner_names": ""
  },
  "doc_metadata": {
    "hierarchy": {
      "source_path": [
        "My Drive"
      ],
      "drive_id": null,
      "file_name": "Design--Add audit trail for AI-generated content lifecycle (create/edit/export/delete).docx",
      "mime_type": "application/vnd.openxmlformats-officedocument.wordprocessingml.document"
    }
  },
  "sections": [
    {
      "text": "### Overview\nWe will add an immutable, server-side audit trail for the full lifecycle of AI-generated artifacts in Sales_Accelerator (emails, call notes, next-best-action recommendations). The system will capture and persist audit events for **generate, view, edit, export, and delete** actions across both **UI and API** entrypoints. This enables compliance reviews and internal investigations by ensuring a reliable record of what was generated, accessed, changed, or removed, and by whom.\n\n### Audit event model and storage\nIntroduce a dedicated append-only `audit_log` store (table or log stream) with a stable schema: `event_id`, `event_type`, `artifact_id`, `artifact_type`, `actor_type` (user/service), `actor_id`, `timestamp`, `source_context` (account_id, opportunity_id, plus optional request/session metadata), and `origin` (UI/API). For edits, we will record `before_snapshot` and `after_snapshot` (or a structured diff if available) sufficient to reconstruct what changed; for delete, capture the last-known snapshot plus deletion metadata. Immutability is enforced by restricting writes to an internal service role and disallowing updates/deletes at the storage layer (e.g., no UPDATE/DELETE privileges, WORM-like policies if supported).\n\n### Capture points and guarantees\nAll audit writes will occur **server-side** at the application/service boundary: generation endpoints, artifact retrieval/view endpoints, update endpoints, export endpoints, and deletion endpoints. The UI will not be trusted to emit audit events; instead, any action that results in artifact access or mutation will trigger a synchronous (or reliably queued) audit append in the same request flow, with failure-handling that errs toward preserving audit integrity (e.g., block mutation/export if audit write fails, while allowing read paths to degrade only if explicitly approved). This ensures coverage regardless of RBAC UI gating and prevents bypass via direct API calls.\n\n### Query and compliance access\nProvide an Admin/Sales Ops query surface (internal API + UI page) that supports filtering by time range, actor, artifact type/ID, account/opportunity context, and event type, with pagination and export for compliance reviews. Access to *view* audit logs will be controlled via dedicated admin permissions, but audit *capture and retention* will be independent of RBAC gating on the underlying artifact. Retention will follow compliance requirements (configurable policy), and logs will be designed to be tamper-evident via append-only semantics and optional integrity measures (e.g., event hashing/chain) if required.",
      "link": "https://www.onyx.app/69701"
    }
  ],
  "primary_owners": [
    "andre_robinson"
  ],
  "secondary_owners": []
}