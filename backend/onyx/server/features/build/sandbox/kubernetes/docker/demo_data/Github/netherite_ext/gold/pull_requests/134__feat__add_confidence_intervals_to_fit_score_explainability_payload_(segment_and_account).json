{
  "id": "https://github.com/onyx-dot-app/onyx#134",
  "semantic_identifier": "134: feat: Add confidence intervals to Fit Score explainability payload (segment + account)",
  "title": null,
  "source": "github",
  "doc_updated_at": "2025-12-16",
  "metadata": {
    "object_type": "PullRequest",
    "id": "134",
    "merged": "False",
    "state": "open",
    "user": {
      "login": "michael_anderson",
      "name": "michael_anderson",
      "email": "michael_anderson@netherite-extraction.onyx.app"
    },
    "assignees": [
      {
        "login": "jiwon_kang",
        "name": "jiwon_kang",
        "email": "jiwon_kang@netherite-extraction.onyx.app"
      }
    ],
    "repo": "netherite-ext/gold",
    "num_commits": "6",
    "num_files_changed": "64",
    "labels": [],
    "created_at": "2025-12-16",
    "updated_at": "2025-12-16",
    "closed_at": ""
  },
  "doc_metadata": {
    "repo": "netherite-ext/gold",
    "hierarchy": {
      "source_path": [
        "netherite-ext",
        "gold",
        "pull_requests"
      ],
      "owner": "netherite-ext",
      "repo": "gold",
      "object_type": "pull_request"
    }
  },
  "sections": [
    {
      "text": "## Description\r\n\r\n## Summary\nThis PR adds confidence interval (CI) bounds to Fit Score explainability outputs for both segment-level and account-level scores. The scoring service now computes interval lower/upper bounds alongside the point estimate, and the API/SDK surfaces these fields in a backwards-compatible manner.\n\n## Changes\n- **Scoring service**\n  - Added CI computation during Fit Score generation for segment and account aggregations.\n  - Returns additional fields per score: `ciLower` and `ciUpper` (same scale as the Fit Score), ensuring bounds are ordered and clamped to the valid score range.\n  - Handles low-signal segments (e.g., sparse samples / low variance) by widening intervals and falling back to a conservative default when required.\n\n- **Explainability payload / API response**\n  - Extended explainability schema to include optional CI fields:\n    - Segment: `fitScore.ciLower`, `fitScore.ciUpper`\n    - Account: `fitScore.ciLower`, `fitScore.ciUpper`\n  - Fields are **additive and optional** to preserve existing clients; no breaking changes to existing keys.\n\n- **SDK updates**\n  - Updated typed models/interfaces to include the optional CI fields.\n  - Ensured deserialization tolerates older responses (no CI) and newer responses (with CI).\n\n## Tests\n- Added unit tests covering:\n  - High-signal segments: intervals narrow appropriately and contain the point estimate.\n  - Low-signal segments: intervals widen / fallback behavior triggers without errors.\n  - Bounds sanity: `ciLower <= score <= ciUpper`, clamping to allowed score range.\n\n## Notes for reviewers / users\n- Consumers can optionally display CI as uncertainty around Fit Scores; existing integrations remain unaffected if they ignore the new fields.\r\n\r\n## How Has This Been Tested?\r\n\r\nstaging\r\n",
      "link": "https://github.com/onyx-dot-app/onyx#134"
    }
  ],
  "primary_owners": [],
  "secondary_owners": []
}