{
  "id": "11cccdc05fef4bc89dcd1df5693cf22c",
  "semantic_identifier": "Design--Define Messaging Library export data model and API contract.docx",
  "title": null,
  "source": "google_doc",
  "doc_updated_at": "2025-10-25",
  "metadata": {
    "owner_names": ""
  },
  "doc_metadata": {
    "hierarchy": {
      "source_path": [
        "My Drive"
      ],
      "drive_id": null,
      "file_name": "Design--Define Messaging Library export data model and API contract.docx",
      "mime_type": "application/vnd.openxmlformats-officedocument.wordprocessingml.document"
    }
  },
  "sections": [
    {
      "text": "### Overview and goals  \nWe need a stable, versioned export contract for the Messaging Library so external sales/marketing tools can reliably ingest *approved* positioning assets (value propositions, differentiators, proof points, objections). This doc defines (1) a canonical export data model, (2) approval/visibility rules for what is eligible to export, (3) identifiers and versioning semantics to support \u201cupdate vs. new\u201d mapping, and (4) the API endpoints/payloads and authentication required for downstream integrations. Non-goals: building the exporter, UI changes, or connector-specific transformations\u2014those will be separate implementation tickets.\n\n### Export data model (canonical schema)  \nDefine an `Asset` as the base exported entity with fields: `id` (immutable UUID), `type` (`value_prop|differentiator|proof_point|objection`), `title`, `body` (primary text), `status` (`approved|draft|deprecated`), `approval` object (`approvedAt`, `approvedBy`, `approvalVersion`), `version` (monotonic integer), `updatedAt`, `createdAt`, `locale`, `tags[]`, `productIds[]/segmentIds[]` (targeting), and `source` object (library/workspace identifiers). Support relationships via `references[]` (links to other asset IDs) and optional structured fields per type (e.g., `objection.response`, `proof_point.evidence`, `differentiator.competitorRefs`). Include `externalMappings[]` entries to store per-destination identifiers (e.g., `system=\"salesforce\"`, `externalId`, `lastSyncedVersion`) to distinguish updates from first-time exports without relying on brittle text matching.\n\n### Versioning, identifiers, and approval rules  \nOnly assets in `status=approved` are exportable by default; `deprecated` assets may be exported only when explicitly requested via query param for backfill/audit use cases. Every edit increments `version`; approval produces an `approvalVersion` snapshot so consumers can choose to track \u201clatest approved\u201d rather than \u201clatest edit.\u201d Export responses include both `version` and `approvalVersion` to enable deterministic syncing. Idempotency is achieved through stable `id` plus `version`: consumers treat an asset as an update when `id` matches and `version` (or `approvalVersion`) increases; otherwise it\u2019s a new record. For bulk sync, provide cursor-based pagination and a `modifiedSince` filter on `updatedAt` and/or `approvedAt`.\n\n### API contract and auth  \nProvide REST endpoints: `GET /v1/exports/messaging-assets` (list with filters: `types`, `status`, `modifiedSince`, `approvedSince`, `limit`, `cursor`), `GET /v1/exports/messaging-assets/{id}` (single asset), and optionally `GET /v1/exports/messaging-assets/schema` (JSON schema + enum values) to reduce integration ambiguity. Responses are JSON with top-level `{ data: Asset[], nextCursor, generatedAt }`. Authentication: OAuth2 client credentials (preferred for external tools) or signed API keys (fallback), with scopes such as `messaging.assets:read` and environment separation (sandbox/prod). Document error codes (401/403/429/5xx), rate limits, and backwards-compat guarantees: additive changes only within a major version, breaking changes require a new `/v2` and deprecation window.",
      "link": "https://www.onyx.app/43311"
    }
  ],
  "primary_owners": [
    "jason_morris"
  ],
  "secondary_owners": []
}