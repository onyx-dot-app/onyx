{
  "id": "https://github.com/onyx-dot-app/onyx#72",
  "semantic_identifier": "72: feat: Persist Customer_Analyzer block metadata and add retrieval API for stale detection",
  "title": null,
  "source": "github",
  "doc_updated_at": "2025-06-08",
  "metadata": {
    "object_type": "PullRequest",
    "id": "72",
    "merged": "False",
    "state": "open",
    "user": {
      "login": "kenji_watanabe",
      "name": "kenji_watanabe",
      "email": "kenji_watanabe@netherite-extraction.onyx.app"
    },
    "assignees": [
      {
        "login": "jiwon_kang",
        "name": "jiwon_kang",
        "email": "jiwon_kang@netherite-extraction.onyx.app"
      }
    ],
    "repo": "netherite-ext/gold",
    "num_commits": "10",
    "num_files_changed": "70",
    "labels": [],
    "created_at": "2025-06-08",
    "updated_at": "2025-06-08",
    "closed_at": ""
  },
  "doc_metadata": {
    "repo": "netherite-ext/gold",
    "hierarchy": {
      "source_path": [
        "netherite-ext",
        "gold",
        "pull_requests"
      ],
      "owner": "netherite-ext",
      "repo": "gold",
      "object_type": "pull_request"
    }
  },
  "sections": [
    {
      "text": "## Description\r\n\r\nThis PR adds persistence + retrieval plumbing in Sales_Accelerator to support stale Customer_Analyzer positioning block detection.\n\nChanges:\n- Data model: extends the rendered positioning-block storage for Account/Opportunity records to also persist:\n  - `customerAnalyzerBlockId` (stable identifier)\n  - `customerAnalyzerBlockVersion` (canonical version at render time)\n  - `customerAnalyzerLastUpdatedAt` (timestamp of the canonical block at render time)\n- Write path: when a Customer_Analyzer positioning block is rendered/saved, the metadata is stored alongside the rendered content (no UI behavior changes in this PR).\n- Read path: introduces a lightweight service/API method to fetch the latest canonical Customer_Analyzer metadata for a given record (id/version/lastUpdatedAt) so the frontend can compare a pasted/edited block vs the canonical source.\n\nNotes:\n- This PR intentionally does not implement the UI staleness comparison, prompts, or replacement flows\u2014only the persistence and retrieval building blocks.\n- Includes schema/migration updates and basic unit/integration coverage for the new fields and service method.\r\n\r\n## How Has This Been Tested?\r\n\r\nstaging\r\n",
      "link": "https://github.com/onyx-dot-app/onyx#72"
    }
  ],
  "primary_owners": [],
  "secondary_owners": []
}