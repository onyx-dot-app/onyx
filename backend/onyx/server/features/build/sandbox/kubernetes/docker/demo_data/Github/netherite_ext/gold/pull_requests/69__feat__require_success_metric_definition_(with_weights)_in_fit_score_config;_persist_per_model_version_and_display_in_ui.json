{
  "id": "https://github.com/onyx-dot-app/onyx#69",
  "semantic_identifier": "69: feat: Require Success Metric definition (with weights) in Fit Score config; persist per model version and display in UI",
  "title": null,
  "source": "github",
  "doc_updated_at": "2025-06-09",
  "metadata": {
    "object_type": "PullRequest",
    "id": "69",
    "merged": "True",
    "state": "closed",
    "user": {
      "login": "sofia_ramirez",
      "name": "sofia_ramirez",
      "email": "sofia_ramirez@netherite-extraction.onyx.app"
    },
    "assignees": [
      {
        "login": "kevin_sullivan",
        "name": "kevin_sullivan",
        "email": "kevin_sullivan@netherite-extraction.onyx.app"
      }
    ],
    "repo": "netherite-ext/gold",
    "num_commits": "5",
    "num_files_changed": "28",
    "labels": [],
    "created_at": "2025-06-09",
    "updated_at": "2025-06-09",
    "closed_at": "2025-06-12"
  },
  "doc_metadata": {
    "repo": "netherite-ext/gold",
    "hierarchy": {
      "source_path": [
        "netherite-ext",
        "gold",
        "pull_requests"
      ],
      "owner": "netherite-ext",
      "repo": "gold",
      "object_type": "pull_request"
    }
  },
  "sections": [
    {
      "text": "## Description\r\n\r\nThis PR makes the Fit Score objective explicit and auditable by adding a required Success Metric definition to segment/model configuration, supporting multi-metric weighting, persisting it with each model version, and surfacing it next to Fit Score in the UI.\n\nKey changes:\n- Config schema/API\n  - Adds `successMetrics: [{ metricKey: string, weight: number }]` to segment/model configuration.\n  - Enforces requirement: at least one metric must be selected.\n  - For multi-metric selections, validates weights are provided, numeric, non-negative, and normalized (server normalizes to sum=1; rejects all-zero).\n  - Backwards compatibility: existing configs without `successMetrics` are rejected on update; migration endpoint/script seeds a default metric where applicable.\n\n- Persistence + versioning\n  - Stores `successMetrics` on the model version record (immutable snapshot) so historical Fit Scores remain tied to the objective at training time.\n  - Updates training/job payload to include the resolved success metric list + normalized weights.\n\n- UI\n  - Adds a required \u201cSuccess Metric\u201d section to the Fit Score configuration form with multi-select and weight inputs (weights only shown when >1 metric selected).\n  - Displays the selected metric(s) + weights alongside Fit Score wherever the score is shown (Fit Score header/tooltip + model version details).\n\n- Validation, tests, and rollout\n  - Adds server-side validation tests for required metric selection and weight normalization.\n  - Adds UI form validation tests to prevent saving invalid configurations.\n  - Includes migration to backfill a default success metric for existing model versions/configs to avoid null rendering.\n\nUser impact:\n- Teams must select at least one Success Metric before saving Fit Score configuration.\n- For multi-metric objectives, teams must provide weights; the UI will show the normalized weights used by the model.\n- Fit Score pages now display the objective definition so all viewers share the same optimization target.\r\n\r\n## How Has This Been Tested?\r\n\r\nstaging\r\n",
      "link": "https://github.com/onyx-dot-app/onyx#69"
    }
  ],
  "primary_owners": [],
  "secondary_owners": []
}