{
  "id": "aa7d4bd8ee524762ab6488bee9565ed6",
  "semantic_identifier": "Design--Add immutable access logs for issue objects and linked evidence.docx",
  "title": null,
  "source": "google_doc",
  "doc_updated_at": "2026-01-16",
  "metadata": {
    "owner_names": ""
  },
  "doc_metadata": {
    "hierarchy": {
      "source_path": [
        "My Drive"
      ],
      "drive_id": null,
      "file_name": "Design--Add immutable access logs for issue objects and linked evidence.docx",
      "mime_type": "application/vnd.openxmlformats-officedocument.wordprocessingml.document"
    }
  },
  "sections": [
    {
      "text": "We should add workspace-scoped, immutable access logging for all reads and writes to \u201cissue\u201d objects and any linked evidence (evidence snippets), plus sensitive decision/status fields. Each log event should capture at minimum: workspace_id, actor (user/service), action type (read/write/update/delete where applicable), object type/id (issue, evidence, field), timestamp, and request context (source IP and user agent when available, plus request_id for traceability). We should instrument all access paths that can touch these objects (API handlers, UI-backed endpoints, background jobs, and internal services) so that both interactive and automated access is captured consistently.\n\nLogs will be stored in a dedicated append-only table (or partitioned tables) with strict invariants: inserts only, no updates/deletes, and protections against tampering (DB permissions limited to insert/select; no application code paths for mutation). Retention should follow existing workspace retention settings by reference (aligned with GOLD-189): the logging system should read the workspace\u2019s configured retention window and automatically expire log partitions/rows accordingly, without duplicating retention configuration. For scale, we should index by (workspace_id, timestamp) plus secondary indexes for (workspace_id, actor_id), (workspace_id, issue_id), and (workspace_id, action) to support compliance queries.\n\nWe should expose an admin-only API endpoint and corresponding UI surface to search and filter access logs within a workspace. Filters should include actor (user/service), issue/evidence identifier, time range, and action type, with pagination and stable sorting (most recent first). Results should show a human-readable summary (who/when/what) and raw request context (IP/UA) when present, and should enforce strict authorization: only workspace admins (or a dedicated compliance role) can query logs, with auditability of access to the log viewer itself as a follow-on.\n\nKey edge cases include: capturing \u201creads\u201d that happen via list endpoints (log at object-level only when details are fetched vs. bulk list), internal system actors (represent as service principals), missing IP/UA for non-request contexts (background jobs), and performance impact (sampling is not acceptable for compliance; instead rely on efficient writes and partitioning). We should validate completeness by adding integration tests around critical endpoints (issue read, issue update, evidence read/write, decision/status changes) and ensure logs are generated exactly once per access and are never blocked by downstream retention/cleanup processes.",
      "link": "https://www.onyx.app/69628"
    }
  ],
  "primary_owners": [
    "kevin_sullivan"
  ],
  "secondary_owners": []
}