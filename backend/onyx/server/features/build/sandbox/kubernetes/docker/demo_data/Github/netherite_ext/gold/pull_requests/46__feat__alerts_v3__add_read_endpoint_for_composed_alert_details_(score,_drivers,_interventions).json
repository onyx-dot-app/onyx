{
  "id": "https://github.com/onyx-dot-app/onyx#46",
  "semantic_identifier": "46: feat: alerts/v3: Add read endpoint for composed alert details (score, drivers, interventions)",
  "title": null,
  "source": "github",
  "doc_updated_at": "2025-12-13",
  "metadata": {
    "object_type": "PullRequest",
    "id": "46",
    "merged": "False",
    "state": "open",
    "user": {
      "login": "sofia_ramirez",
      "name": "sofia_ramirez",
      "email": "sofia_ramirez@netherite-extraction.onyx.app"
    },
    "assignees": [
      {
        "login": "ryan_murphy",
        "name": "ryan_murphy",
        "email": "ryan_murphy@netherite-extraction.onyx.app"
      }
    ],
    "repo": "netherite-ext/gold",
    "num_commits": "4",
    "num_files_changed": "16",
    "labels": [],
    "created_at": "2025-12-13",
    "updated_at": "2025-12-13",
    "closed_at": ""
  },
  "doc_metadata": {
    "repo": "netherite-ext/gold",
    "hierarchy": {
      "source_path": [
        "netherite-ext",
        "gold",
        "pull_requests"
      ],
      "owner": "netherite-ext",
      "repo": "gold",
      "object_type": "pull_request"
    }
  },
  "sections": [
    {
      "text": "## Description\r\n\r\n## Summary\nAdds a versioned read API under `/alerts/v3` to fetch a fully composed alert payload (risk score output, ranked drivers with evidence, and recommended interventions with rationale) for a given account/opportunity. The endpoint is gated behind the existing feature flag and is designed for stable, UI-friendly consumption.\n\n## What\u2019s included\n- **New endpoint**: `GET /alerts/v3/:crm/:objectType/:objectId` (e.g., Salesforce/HubSpot + Account/Opportunity) that returns the composed alert details.\n- **Stable response schema**:\n  - Top-level metadata (version, object identifiers, generated timestamp)\n  - **Score**: risk type, score, confidence, model/version identifiers\n  - **Drivers**: ranked list with deterministic ordering; each driver includes id/name, rank, contribution/weight, and **evidence** (normalized fields across CRMs)\n  - **Interventions**: ordered list with type, priority, and **rationale** (links to drivers/evidence when available)\n- **Filtering + pagination**:\n  - Query params for `riskType`, score/confidence thresholds, and list windowing (e.g., `limit`, `cursor`/`offset`) for drivers/interventions.\n- **Consistent null/missing handling**:\n  - Normalizes Salesforce vs HubSpot data gaps by using explicit `null` for known-but-missing values and omitting only truly non-applicable sections.\n  - Ensures arrays default to `[]` when empty.\n\n## Implementation notes\n- Introduces an `alertsV3` controller + service that composes the response from existing scoring/driver/intervention sources.\n- Adds a schema/serializer layer to enforce field names, types, and ordering.\n- Ensures deterministic ordering for drivers/interventions (primary sort by rank/priority, secondary stable tie-breakers).\n- Reuses existing feature flag checks at the routing layer to prevent exposure when disabled.\n\n## Tests\n- Adds integration tests covering:\n  - Schema compatibility (required/optional fields, null/empty behavior)\n  - Deterministic ordering across runs\n  - Filtering and pagination behavior\n  - Salesforce vs HubSpot normalization scenarios\n\n## Notes for reviewers\nThis is a read-only API addition and is low-risk: no migrations, no write paths, and fully gated behind the existing feature flag.\r\n\r\n## How Has This Been Tested?\r\n\r\nlocal\r\n",
      "link": "https://github.com/onyx-dot-app/onyx#46"
    }
  ],
  "primary_owners": [],
  "secondary_owners": []
}