{
  "id": "https://github.com/onyx-dot-app/onyx#24",
  "semantic_identifier": "24: feat: Export API: outbound webhooks for Messaging Library asset approval + approved-version updates (signed + retries)",
  "title": null,
  "source": "github",
  "doc_updated_at": "2026-01-03",
  "metadata": {
    "object_type": "PullRequest",
    "id": "24",
    "merged": "False",
    "state": "open",
    "user": {
      "login": "kenji_watanabe",
      "name": "kenji_watanabe",
      "email": "kenji_watanabe@netherite-extraction.onyx.app"
    },
    "assignees": [
      {
        "login": "kevin_sullivan",
        "name": "kevin_sullivan",
        "email": "kevin_sullivan@netherite-extraction.onyx.app"
      }
    ],
    "repo": "netherite-ext/gold",
    "num_commits": "6",
    "num_files_changed": "61",
    "labels": [],
    "created_at": "2026-01-03",
    "updated_at": "2026-01-03",
    "closed_at": ""
  },
  "doc_metadata": {
    "repo": "netherite-ext/gold",
    "hierarchy": {
      "source_path": [
        "netherite-ext",
        "gold",
        "pull_requests"
      ],
      "owner": "netherite-ext",
      "repo": "gold",
      "object_type": "pull_request"
    }
  },
  "sections": [
    {
      "text": "## Description\r\n\r\nImplements outbound webhook notifications for Messaging Library assets when (1) an asset transitions to Approved and (2) an already-approved asset receives a new published version.\n\nKey changes:\n- Eventing\n  - Adds two webhook event types: `messaging_library.asset.approved` and `messaging_library.asset.approved_updated`.\n  - Emits events from the asset approval transition and from version/publish flows when `status=Approved` and a new version is created.\n  - Ensures idempotent event generation per (asset_id, asset_version, event_type) to prevent duplicate sends on retries/replays.\n\n- Payload contract\n  - Webhook JSON payload includes:\n    - `asset_id`, `external_id`, `asset_version`\n    - `approved_at` (for approved transition) and/or `updated_at` (for approved updates)\n    - `summary` (minimal fields needed for downstream targeted re-sync)\n  - Includes `event_type`, `event_id`, and `occurred_at` for downstream dedupe/ordering.\n\n- Signing\n  - Adds HMAC-SHA256 request signing using a per-destination shared secret.\n  - Sends signature + timestamp headers (e.g., `X-Webhook-Signature`, `X-Webhook-Timestamp`, `X-Webhook-Event-Id`) to support verification and replay protection.\n\n- Delivery + reliability\n  - Persists outbound deliveries and processes them asynchronously via a worker/queue.\n  - Implements retries with exponential backoff and max-attempts configuration.\n  - On terminal failure, records a dead-letter entry with response status/body snippet, last error, and correlation identifiers for operational triage.\n\n- Configuration/API\n  - Extends webhook destination model/config to support enabling these event types and storing the shared secret.\n  - Validates destination URLs and provides safe defaults for retry parameters.\n\nNotes for users/operators:\n- Downstream systems should verify signatures using the shared secret and use `event_id` for deduplication.\n- On receipt, consumers can call existing export endpoints using `asset_id`/`external_id` + `asset_version` to perform a targeted re-sync.\r\n\r\n## How Has This Been Tested?\r\n\r\nstaging\r\n",
      "link": "https://github.com/onyx-dot-app/onyx#24"
    }
  ],
  "primary_owners": [],
  "secondary_owners": []
}