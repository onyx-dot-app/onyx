{
  "id": "https://github.com/onyx-dot-app/onyx#74",
  "semantic_identifier": "74: feat: Setup: Add Fit Driver Selection Wizard with recommended defaults + workspace persistence",
  "title": null,
  "source": "github",
  "doc_updated_at": "2025-06-15",
  "metadata": {
    "object_type": "PullRequest",
    "id": "74",
    "merged": "True",
    "state": "closed",
    "user": {
      "login": "sofia_ramirez",
      "name": "sofia_ramirez",
      "email": "sofia_ramirez@netherite-extraction.onyx.app"
    },
    "assignees": [
      {
        "login": "tyler_jenkins",
        "name": "tyler_jenkins",
        "email": "tyler_jenkins@netherite-extraction.onyx.app"
      }
    ],
    "repo": "netherite-ext/gold",
    "num_commits": "7",
    "num_files_changed": "59",
    "labels": [],
    "created_at": "2025-06-15",
    "updated_at": "2025-06-15",
    "closed_at": "2025-07-12"
  },
  "doc_metadata": {
    "repo": "netherite-ext/gold",
    "hierarchy": {
      "source_path": [
        "netherite-ext",
        "gold",
        "pull_requests"
      ],
      "owner": "netherite-ext",
      "repo": "gold",
      "object_type": "pull_request"
    }
  },
  "sections": [
    {
      "text": "## Description\r\n\r\n### Summary\nAdds a new guided \u201cFit Driver Selection\u201d step to the setup flow that recommends a default set of fit drivers based on currently connected data sources (CRM fields, surveys, product usage events, support tickets). Users can review short explanations, accept all recommendations, or add/remove drivers before continuing. Selections are persisted to the workspace and used consistently by downstream fit scoring.\n\n### Key changes\n- **New setup step**: Inserted `FitDriverSelectionStep` into the setup wizard sequence.\n- **Recommendation engine (server-side)**:\n  - Computes `recommendedDrivers` from detected integrations + available schema (e.g., CRM fields presence, survey questions/attributes, event taxonomy, ticket categories).\n  - Returns each driver with a `reason` string used for inline UI explanations.\n  - Handles partial connectivity gracefully (only recommends what can be supported by available sources).\n- **UI behavior**:\n  - Pre-populates the list with recommended drivers checked.\n  - Adds **\u201cAccept all\u201d** action to select all recommended drivers.\n  - Allows manual add/remove via multi-select (recommended vs custom clearly separated).\n  - Validates at least one driver selected before enabling \u201cContinue\u201d.\n- **Persistence + config model**:\n  - Persists `workspace.fitDriverConfig` including `selectedDrivers`, `recommendedDriversSnapshot`, and `dataSourceSignals` used to generate defaults.\n  - Fit scoring now reads from `workspace.fitDriverConfig.selectedDrivers` as the single source of truth.\n- **APIs / data flow**:\n  - `GET /api/workspaces/:id/fit-drivers/recommendations` returns computed recommendations.\n  - `PUT /api/workspaces/:id/fit-drivers/config` stores user selections and defaults.\n- **Tests**:\n  - Unit tests for recommendation logic across combinations of connected sources.\n  - Integration tests for setup flow step completion + persistence.\n\n### Notes for reviewers / deploy\n- Includes a small DB migration to add `fit_driver_config` (or equivalent JSON column) to workspace.\n- Backwards compatible: existing workspaces without config fall back to current fit scoring defaults until the step is completed.\n\r\n\r\n## How Has This Been Tested?\r\n\r\nlocal\r\n",
      "link": "https://github.com/onyx-dot-app/onyx#74"
    }
  ],
  "primary_owners": [],
  "secondary_owners": []
}