name: Require beta cherry-pick consideration
concurrency:
  group: Require-Beta-Cherrypick-Consideration-${{ github.workflow }}-${{ github.head_ref || github.event.workflow_run.head_branch || github.run_id }}
  cancel-in-progress: true

on:
  pull_request:
    types: [opened, edited, reopened, synchronize]

permissions:
  contents: read

jobs:
  beta-cherrypick-check:
    runs-on: ubuntu-latest
    timeout-minutes: 45
    steps:
      - name: Check PR body for beta cherry-pick consideration (non-blocking)
        env:
          PR_BODY: ${{ github.event.pull_request.body || '' }}
        run: |
          if echo "$PR_BODY" | grep -qiE "\\[x\\][[:space:]]*(\\[[^]]+\\][[:space:]]*)?I have considered whether this PR needs to be cherry[- ]picked to the latest beta branch"; then
            echo "Cherry-pick consideration box is checked. Auto cherry-pick helper can run after merge."
            exit 0
          fi

          echo "Cherry-pick consideration box is not checked. This does not block merge."
          exit 0
